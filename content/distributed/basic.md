---
title: "分布式系统基础"
date: 2023-08-09T21:55:02+08:00
---

## 1 分布式系统概念

### 1.1 分布式系统的特性：
- 分布性：在空间上随机分布
- 对等性：分布式系统中的成员没有主从之分
- 并发性：程序运行中的并发性操作是很正常的事
- 缺乏全局时钟：缺乏一个全局的时钟序列控制
- 故障总是会发生：组成分布式系统的计算机，可能以任何形式发生故障

### 1.2 事务相关

- ACID
  - 原子性：事务必须是一个原子的操作序列单元
  - 一致性：一个事务在执行前后都必须处于一致性的状态
  - 隔离性：在并发环境下，事务之间是相互隔离的
  - 持久性：一旦一个事务提交，那么它对于数据库中状态变更也应该是持久的


### 1.3 CAP定理

- 一致性：数据在多个副本之间可以维持一致性
- 可用性：系统一直处于可用的状态
- 分区容错性：在任何网络分区出现故障时还可以提供服务


## 2. 一致性协议

### 2.1 2PC与3PC

2PC(Two-Phase Commit) 二阶段提交

在二阶段提交中，事务的提交被分为是两个阶段

- 第一阶段：
  - 事务询问
  - 执行事务
  - 各参与者向协调者反馈事务询问的响应
- 第二阶段：
  - 假设所有参与者的反馈都是yes
    - 执行事务提交
    - 事务提交
    - 反馈事务提交
    - 完成事务
  - 假设存在no
    - 发送回滚请求
    - 事务回滚
    - 反馈事务回滚结果
    - 中断事务

3PC(Three-Phase Commit) 三阶段提交

将第二阶段的提交事务请求分为两个部分，形成了CanCommit, PreCommit, do Commit. 

- CanCommit
  -  事务询问
  -  各参与者向协调者反馈事务的响应
- PreCommit
  - 发生预提交请求
  - 事务预提交
  - 各参与者向协调反馈事务执行的响应


### 2.2 Paxos 算法

